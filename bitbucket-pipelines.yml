# This is a sample build configuration for Java (Maven).
# Check our guides at https://confluence.atlassian.com/x/zd-5Mw for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.
image: maven:3.5-jdk-9

pipelines:
  default:
    - step:
        caches:
          - maven
        script:
          - wget https://dl.bintray.com/jfrog/jfrog-cli-go/1.7.1/jfrog-cli-linux-amd64/jfrog
          - chmod +x jfrog
          - mvn -B clean install:install
          - ./jfrog rt config --url $ARTIFACTORY_URL --user $ARTIFACTORY_USER --apikey $ARTIFACTORY_PASSWORD
          - ./jfrog rt u "multi*/*.pom" pipeline-generic-local --build-name=pipeline-generic-artifactory --build-number=$BITBUCKET_COMMIT --flat=false
          - ./jfrog rt bce pipeline-generic-artifactory $BITBUCKET_COMMIT
          - ./jfrog rt bp pipeline-generic-artifactory $BITBUCKET_COMMIT